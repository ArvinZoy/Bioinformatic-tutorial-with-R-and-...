#!usr/bin/perl -w
use strict;
my $inputfile =<STDIN>;
chomp($inputfile);
open(INPUT, "<$inputfile")||die("cannot open the file $inputfile\n");
open(OUT,">$inputfile-transition.ped.txt")||die $!;
open (OUT1,">$inputfile-transition.infor.txt") || die $!;
my (@diarray, @array,@arraytotal);

my $line1 = "CH1305	CH1003	CH1004	CH1005	CH1008	CH1009	CH1012	CH1013	CH1014	CH1015	CH1016	CH1017	CH1018	CH1019	CH1021	CH1022	CH1023	CH1024	CH1027	CH1028	CH1029	CH1030	CH1032	CH1034	CH1035	CH1037	CH1039	CH1041	CH1044	CH1045	CH1046	CH1048	CH1049	CH1054	CH1056	CH1059	CH1060	CH1061	CH1062	CH1063	CH1067	CH1068	CH1070	CH1071	CH1072	CH1076	CH1077	CH1082	CH1087	CH1090	CH1091	CH1092	CH1097	CH1098	CH1099	CH1100	CH1101	CH1102	CH1103	CH1104	CH1109	CH1110	CH1113	CH1116	CH1118	CH1119	CH1120	CH1122	CH1126	CH1128	CH1129	CH1131	CH1132	CH1134	CH1137	CH1141	CH1144	CH1145	CH1148	CH1149	CH1150	CH1155	CH1158	CH1159	CH1161	CH1162	CH1164	CH1165	CH1166	CH1167	CH1169	CH1170	CH1179	CH1183	CH1184	CH1185	CH1186	CH1190	CH1191	CH1193	CH1194	CH1196	CH1198	CH1202	CH1204	CH1205	CH1208	CH1209	CH1210	CH1211	CH1213	CH1214	CH1215	CH1219	CH1223	CH1224	CH1226	CH1227	CH1229	CH1230	CH1232	CH1233	CH1234	CH1235	CH1236	CH1237	CH1238	CH1239	CH1241	CH1242	CH1243	CH1245	CH1246	CH1247	CH1248	CH1249	CH1250	CH1251	CH1253	CH1255	CH1259	CH1260	CH1265	CH1267	CH1268	CH1269	CH1274	CH1276	CH1277	CH1278	CH1283	CH1284	CH1288	CH1289	CH1291	CH1293	CH1297	CH1298	CH1001	CH1002	CH1006	CH1010	CH1020	CH1026	CH1038	CH1050	CH1055	CH1057	CH1064	CH1069	CH1073	CH1074	CH1075	CH1081	CH1083	CH1085	CH1086	CH1088	CH1093	CH1094	CH1095	CH1096	CH1105	CH1106	CH1107	CH1108	CH1111	CH1112	CH1114	CH1117	CH1125	CH1130	CH1133	CH1139	CH1142	CH1146	CH1147	CH1151	CH1152	CH1156	CH1163	CH1168	CH1171	CH1173	CH1180	CH1181	CH1182	CH1187	CH1189	CH1195	CH1197	CH1199	CH1216	CH1217	CH1220	CH1221	CH1222	CH1225	CH1228	CH1231	CH1240	CH1244	CH1252	CH1256	CH1257	CH1258	CH1262	CH1263	CH1264	CH1266	CH1271	CH1272	CH1273	CH1275	CH1281	CH1282	CH1285	CH1286	CH1290	CH1294	CH1295	CH1296	CH1299	CH1302	CX10	CX101	CX102	CX104	CX106	CX107	CX108	CX109	CX11	CX110	CX111	CX112	CX12	CX120	CX122	CX126	CX129	CX13	CX130	CX131	CX133	CX134	CX14	CX140	CX141	CX143	CX145	CX146	CX147	CX148	CX149	CX15	CX150	CX151	CX152	CX153	CX154	CX155	CX156	CX157	CX160	CX161	CX17	CX19	CX2	CX20	CX205	CX212	CX219	CX22	CX220	CX221	CX227	CX23	CX231	CX232	CX235	CX236	CX237	CX24	CX241	CX247	CX248	CX249	CX25	CX26	CX262	CX266	CX267	CX27	CX275	CX28	CX280	CX282	CX284	CX286	CX287	CX3	CX30	CX307	CX313	CX315	CX317	CX319	CX33	CX34	CX340	CX341	CX342	CX343	CX344	CX345	CX348	CX35	CX350	CX355	CX356	CX357	CX358	CX359	CX360	CX361	CX366	CX367	CX37	CX371	CX372	CX374	CX375	CX376	CX377	CX378	CX380	CX381	CX389	CX390	CX393	CX397	CX399	CX4	CX43	CX431	CX45	CX46	CX49	CX5	CX51	CX53	CX534	CX54	CX542	CX548	CX55	CX56	CX57	CX58	CX59	CX6	CX60	CX63	CX64	CX65	CX66	CX68	CX69	CX70	CX71	CX72	CX73	CX74	CX75	CX76	CX77	CX78	CX8	CX80	CX82	CX85	CX88	CX89	CX9	CX94	CX96	CX97	CX99";
my $line2 = "CH1305	CH1003	CH1004	CH1005	CH1008	CH1009	CH1012	CH1013	CH1014	CH1015	CH1016	CH1017	CH1018	CH1019	CH1021	CH1022	CH1023	CH1024	CH1027	CH1028	CH1029	CH1030	CH1032	CH1034	CH1035	CH1037	CH1039	CH1041	CH1044	CH1045	CH1046	CH1048	CH1049	CH1054	CH1056	CH1059	CH1060	CH1061	CH1062	CH1063	CH1067	CH1068	CH1070	CH1071	CH1072	CH1076	CH1077	CH1082	CH1087	CH1090	CH1091	CH1092	CH1097	CH1098	CH1099	CH1100	CH1101	CH1102	CH1103	CH1104	CH1109	CH1110	CH1113	CH1116	CH1118	CH1119	CH1120	CH1122	CH1126	CH1128	CH1129	CH1131	CH1132	CH1134	CH1137	CH1141	CH1144	CH1145	CH1148	CH1149	CH1150	CH1155	CH1158	CH1159	CH1161	CH1162	CH1164	CH1165	CH1166	CH1167	CH1169	CH1170	CH1179	CH1183	CH1184	CH1185	CH1186	CH1190	CH1191	CH1193	CH1194	CH1196	CH1198	CH1202	CH1204	CH1205	CH1208	CH1209	CH1210	CH1211	CH1213	CH1214	CH1215	CH1219	CH1223	CH1224	CH1226	CH1227	CH1229	CH1230	CH1232	CH1233	CH1234	CH1235	CH1236	CH1237	CH1238	CH1239	CH1241	CH1242	CH1243	CH1245	CH1246	CH1247	CH1248	CH1249	CH1250	CH1251	CH1253	CH1255	CH1259	CH1260	CH1265	CH1267	CH1268	CH1269	CH1274	CH1276	CH1277	CH1278	CH1283	CH1284	CH1288	CH1289	CH1291	CH1293	CH1297	CH1298	CH1001	CH1002	CH1006	CH1010	CH1020	CH1026	CH1038	CH1050	CH1055	CH1057	CH1064	CH1069	CH1073	CH1074	CH1075	CH1081	CH1083	CH1085	CH1086	CH1088	CH1093	CH1094	CH1095	CH1096	CH1105	CH1106	CH1107	CH1108	CH1111	CH1112	CH1114	CH1117	CH1125	CH1130	CH1133	CH1139	CH1142	CH1146	CH1147	CH1151	CH1152	CH1156	CH1163	CH1168	CH1171	CH1173	CH1180	CH1181	CH1182	CH1187	CH1189	CH1195	CH1197	CH1199	CH1216	CH1217	CH1220	CH1221	CH1222	CH1225	CH1228	CH1231	CH1240	CH1244	CH1252	CH1256	CH1257	CH1258	CH1262	CH1263	CH1264	CH1266	CH1271	CH1272	CH1273	CH1275	CH1281	CH1282	CH1285	CH1286	CH1290	CH1294	CH1295	CH1296	CH1299	CH1302	CX10	CX101	CX102	CX104	CX106	CX107	CX108	CX109	CX11	CX110	CX111	CX112	CX12	CX120	CX122	CX126	CX129	CX13	CX130	CX131	CX133	CX134	CX14	CX140	CX141	CX143	CX145	CX146	CX147	CX148	CX149	CX15	CX150	CX151	CX152	CX153	CX154	CX155	CX156	CX157	CX160	CX161	CX17	CX19	CX2	CX20	CX205	CX212	CX219	CX22	CX220	CX221	CX227	CX23	CX231	CX232	CX235	CX236	CX237	CX24	CX241	CX247	CX248	CX249	CX25	CX26	CX262	CX266	CX267	CX27	CX275	CX28	CX280	CX282	CX284	CX286	CX287	CX3	CX30	CX307	CX313	CX315	CX317	CX319	CX33	CX34	CX340	CX341	CX342	CX343	CX344	CX345	CX348	CX35	CX350	CX355	CX356	CX357	CX358	CX359	CX360	CX361	CX366	CX367	CX37	CX371	CX372	CX374	CX375	CX376	CX377	CX378	CX380	CX381	CX389	CX390	CX393	CX397	CX399	CX4	CX43	CX431	CX45	CX46	CX49	CX5	CX51	CX53	CX534	CX54	CX542	CX548	CX55	CX56	CX57	CX58	CX59	CX6	CX60	CX63	CX64	CX65	CX66	CX68	CX69	CX70	CX71	CX72	CX73	CX74	CX75	CX76	CX77	CX78	CX8	CX80	CX82	CX85	CX88	CX89	CX9	CX94	CX96	CX97	CX99";

my $line3 ="0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0";
my $line4 ="0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0";
my $line5 ="0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0";
my $line6 ="0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0";

chomp($line1); chomp($line2); chomp($line3); chomp($line4); chomp($line5); chomp($line6);
my @aa1= split(/\t/,$line1); print "$aa1[0]\t$aa1[1]\n";
my @aa2= split(/\t/,$line2);
my @aa3= split(/\t/,$line3);
my @aa4= split(/\t/,$line4);
my @aa5= split(/\t/,$line5);
my @aa6= split(/\t/,$line6);
push @diarray ,[@aa1]; push @diarray ,[@aa2]; push @diarray ,[@aa3]; push @diarray ,[@aa4];push @diarray ,[@aa5];push @diarray ,[@aa6];

#print "$diarray[0][0]\t$diarray[0][1]\n";


while(my $line= <INPUT>){
    chomp($line);   @array = ();
  my @tmparray = split(/\s/,$line);
  my $snp = "$tmparray[0]\_$tmparray[1]";  my $pos = $tmparray[1];
  print "$tmparray[0]\t";
  shift @tmparray;  shift @tmparray; # 去掉第一个染色体表头信息
  print "$tmparray[0]\n";
  foreach(0 .. $#tmparray){
   my $base = "";
   if ($tmparray[$_] =~/[ATGC]{1}/) {
       $base = "$tmparray[$_] $tmparray[$_]";
    } elsif ($tmparray[$_] =~/[MRSKYW]{1}/) {

      if ($tmparray[$_] eq "M") {
        $base ="A C";
      } elsif ($tmparray[$_]eq "R") {
          $base ="A G";
      } elsif ($tmparray[$_] eq "W") {
          $base ="A T";
     } elsif ($tmparray[$_]eq "S") {
          $base ="C G";
     } elsif ($tmparray[$_]eq "Y") {
          $base ="C T";
     } else {$base ="G T";}
     }  else { $base ="0 0"; }


     push @array, $base;
   } # for循环结束
   print OUT1 "$snp $pos\n";
    push @diarray, [@array];     print "@array\n";
 }  # while循环结束

print "$#diarray\n";   print "$#{$diarray[0]}\n";
foreach my $i(0 .. $#diarray){
   foreach my $j (0 .. $#{$diarray[$i]}) {
   chomp($diarray[$i][$j]);
   $arraytotal[$j][$i] =  $diarray[$i][$j];
   }
}
print "$#arraytotal\n";   print "$#{$arraytotal[0]}\n";

foreach my $l(0 .. $#arraytotal){

 foreach my $n(0 .. $#{$arraytotal[$l]}) {
    if ($arraytotal[$l][$n] ne "") {
     print OUT "$arraytotal[$l][$n] ";   #此处用的是tab空格， 也可改为space空格！
     }
  }
   print OUT "\n";

}


close INPUT;
close OUT;
close OUT1;
exit;